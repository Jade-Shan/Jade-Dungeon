var net=net||{};!function(e){net.jadedungeon=function(){return n(),this};var a=net.jadedungeon.prototype,n=function(e){a.ui={},a.data={},a.cfg={ajaxTimeout:5e3},a.markdown=new showdown.Converter,a.data.nav=[{title:"Journal",link:"/"},{title:"Gallery",link:"/gallery.html"},{title:"Note",link:"/study/study/wiki_html",isNewWin:!0},{title:"About Me",subs:[{title:"Github",link:"https://github.com/Jade-Shan/",isNewWin:!0},{title:"",link:""},{title:"Resume",link:"/resume.html"}]}]};a.renderTopNav=function(n){var t=function(e,a){""===e.title?o+='<li class="divider"></li>':(o+=a&&a.pageTitle===e.title?'<li class="active">':"<li>",o=e.isNewWin?o+'<a target="_blank" href="'+e.link+'">':o+'<a href="'+e.link+'">',o=o+e.title+"</a></li>")},i=function(a){o+='<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">',o+=a.title,o+='<b class="caret"></b></a><ul class="dropdown-menu">',e.each(a.subs,function(e,a){t(a,!1)}),o+="</ul></li>"},o='<div class="navbar-header"> <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#example-navbar-collapse"> <span class="sr-only">切换导航</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/">Jade Dungeon</a> </div> <div class="collapse navbar-collapse" id="example-navbar-collapse"> <ul class="nav navbar-nav">';e.each(a.data.nav,function(e,a){a.link?t(a,n):a.subs&&i(a)}),o+="</ul></div>",e("#topnav").html(o)},a.renderSubTitle=function(a){e("#subTitle").html(a.subTitle)},a.renderPagination=function(e,a,n){var t=1,i='<ul class="pagination center">';for(1===e?i+='<li><a class="disable" href="javascript:void(0);">&laquo;</a></li>':i=i+'<li><a href="javascript:'+n+"("+t+');">&laquo;</a></li>';e>t;)i=i+'<li><a href="javascript:'+n+"("+t+');">'+t+"</a></li>",t+=1;for(i=i+'<li class="active"><a href="javascript:void(0);">'+e+"</a></li>",t=e+1;a>=t;)i=i+'<li><a href="javascript:'+n+"("+t+');">'+t+"</a></li>",t+=1;return e===a?i+='<li><a class="disable" href="javascript:void(0);">&raquo;</a></li>':i=i+'<li><a href="javascript:'+n+"("+a+');">&raquo;</a></li>',i+="</ul>"},a.renderPhotoFrame=function(){var a='<div class="modal-dialog"><div class="modal-content">';a+='<div class="modal-header">',a+='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>',a+='<h4 class="modal-title" id="photo-frame-label"></h4></div>',a+='<div class="modal-body row">',a+='<img id="photo-frame-img" alt="" src="" class="col-xs-12 col-sm-12 col-md-12 col-lg-12" >',a+="</div></div>",e("#photo-frame").html(a)},a.renderPicItem=function(e){var a='<div class="col-sm-6 col-md-3"><div class="thumbnail">';return a=a+'<img onClick="javascript:net.jadedungeon.viewPic(this)" id="'+e.id+'" src="'+e.url+'" alt="'+e.title+'"></div>',a=a+'<div class="caption"><h3>'+e.title+"</h3><p>"+e.desc+"</p></div></div>"},a.renderArticle=function(n){var t='<div class="item">';t=t+'<div class="title">'+n.title+"</div>";var i=new Date;return i.setTime(n.time),t=t+'<div class="metadata">'+i.toLocaleString()+" by "+n.auth+"</div>",t=t+'<div class="body">'+net.jadedungeon.markdown.makeHtml(n.text)+"</div>",t+="</div>",n.ablum&&n.ablum.length>0&&(t+='<div class="row">',e.each(n.ablum,function(e,n){t+=a.renderPicItem(n)}),t+="</div>"),t+='<div class="divider"><span></span></div>'},a.viewPic=function(a){var n=e(a);e("#photo-frame-label").html(n.attr("alt")),e("#photo-frame-img").attr("src",n.attr("src")),e("#photo-frame-img").attr("alt",n.attr("alt")),e("#photo-frame").modal("show")}}(jQuery),function(e){net.jadedungeon.gallery=function(e){return n(e),this};var a=net.jadedungeon.gallery.prototype,n=function(e){net.jadedungeon=new net.jadedungeon,a.initCfg=e};a.render=function(){net.jadedungeon.renderTopNav(a.initCfg),net.jadedungeon.renderSubTitle(a.initCfg),net.jadedungeon.renderPhotoFrame()},a.renderGallery=function(a){var n='<div class="spacer"></div>';e.each(a.articles,function(e,a){n+=net.jadedungeon.renderArticle(a)}),n+=net.jadedungeon.renderPagination(a.page,a.count,"page.loadPage"),e("#articles").html(n)},a.loadPage=function(n,t){e.ajax({url:encodeURI(a.initCfg.apiRoot+"findGallery/"+n+"/"+t),type:"GET",dataType:"json",data:{},timeout:net.jadedungeon.ajaxTimeout,success:function(n,t,i){"success"==n.status?(a.renderGallery(n),e("html,body").animate({scrollTop:0},700)):console.error("加载相册失败")},error:function(e,a,n){console.error("加载相册失败"),console.debug(e),console.debug(a),console.debug(n)},complete:function(e,a){}})}}(jQuery),function(e){net.jadedungeon.journal=function(e){return n(e),this};var a=net.jadedungeon.journal.prototype,n=function(e){net.jadedungeon=new net.jadedungeon,a.initCfg=e};a.render=function(){net.jadedungeon.renderTopNav(a.initCfg),net.jadedungeon.renderSubTitle(a.initCfg),net.jadedungeon.renderPhotoFrame()},a.renderJournal=function(a){var n='<div class="spacer"></div>';e.each(a.articles,function(e,a){n+=net.jadedungeon.renderArticle(a)}),n+=net.jadedungeon.renderPagination(a.page,a.count,"page.loadPage"),e("#articles").html(n),e("#articles>.item>.body>p>img").each(function(a,n){var t=e(n);t.unbind("click").bind("click",function(e){net.jadedungeon.viewPic(n)})})},a.loadPage=function(n,t){e.ajax({url:encodeURI(a.initCfg.apiRoot+"findJournal/"+n+"/"+t),type:"GET",dataType:"json",data:{},timeout:net.jadedungeon.ajaxTimeout,success:function(n,t,i){"success"==n.status?(a.renderJournal(n),e("html,body").animate({scrollTop:0},700)):console.error("加载日记失败")},error:function(e,a,n){console.error("加载日记失败"),console.debug(e),console.debug(a),console.debug(n)},complete:function(e,a){}})}}(jQuery);var ccc=5;